
MOD制作に必須なテクスチャについての簡単な説明です。



■ テクスチャって何？

3Dモデルの表面に貼り付ける画像のことです。
DOA5LRではDDSというフォーマットを使用します。
それ以外のフォーマットの画像を使いたい場合はDDSに変換する必要があります。



■ アルファチャンネルって何？

32bitカラーの画像は 赤 緑 青 透明 の情報が入っています。
それぞれをチャンネルと言うのですが、そのうちの透明のチャンネルが「アルファチャンネル」になります。
（赤、緑、青はそれぞれ、Rチャンネル、Gチャンネル、Bチャンネル）
ただしゲームではアルファチャンネルを透明以外の情報として扱う場合があります。



■ DOA5LRでのテクスチャの種類

「～マップ用テクスチャ」と書いていますが「～マップ」と呼ばれる場合も多いです。


□ 3DCGでも一般的に使用されるテクスチャ

ディフューズマップ用テクスチャ
  モデルの色を表現するためのテクスチャです

ノーマルマップ用テクスチャ
  モデルの凹凸を表現するためのテクスチャです
  見た目は紫の画像です

スペキュラマップ用テクスチャ
  モデルの光沢を表現するためのテクスチャです
  グレースケールの画像だったりカラーの画像だったりします

環境マップ用テクスチャ
  モデルの周りの環境の様子をモデルに反映させるように見せるテクスチャです
  テッカテカに見せたりできます


□ 一般的には使用されないがDOA5LRで使用されるテクスチャ

汚れ用テクスチャ（汚れマスク用テクスチャ）
  ゲーム上でモデルが汚れた時に汚れる部分を設定するためのテクスチャです
  このテクスチャはマスクなので実際の汚れはステージによって変わります



■ 濡れると透けたように見えるオブジェクトのテクスチャ

濡れると透けたように見えるオブジェクトがありますが、実際には通常のテクスチャに濡れた時用テクスチャを重ねて透明度を変化させています。
このオブジェクトをこのテキストでは便宜的に「濡れるとテクスチャが変わるオブジェクト」としています。
なお、肌のオブジェクトもこれに含まれます。



■ オブジェクト毎のよく使われるパターン例

使われるテクスチャの種類はある程度のパターンがあります。
もちろん下に書いたパターン以外にも色々とありますが、大体こんな感じです。
（Tex1～ はTMC Object Toolでの表示になります）

一番良くあるパターン
  Tex1 ディフューズ
  Tex2 汚れ
  Tex3 ノーマル
  Tex4 スペキュラ

肌のオブジェクト
  Tex1 ディフューズ（アルファチャンネルはスペキュラ）
  Tex2 汗のディフューズ（アルファチャンネルはスペキュラ）
  Tex3 ノーマル（ボリュームマップ）
  Tex4 汚れ

濡れると透けたように見えるオブジェクト
  Tex1 濡れる前のディフューズ（アルファチャンネルはスペキュラ）
  Tex2 透けたように見せるディフューズ（アルファチャンネルはスペキュラ）
  Tex3 ノーマル（ボリュームマップ）
  Tex4 汚れ

汚れないオブジェクト
  Tex1 ディフューズ
  Tex2 ノーマル
  Tex3 スペキュラ

金属系などのテカテカしたオブジェクト
  Tex1 ディフューズ
  Tex2 ノーマル
  Tex3 環境

※ ボリュームマップについては後述



■ DDSを作成・編集するには

DDSの作成・編集にはPhotoshopやGIMPなどのDDSに対応する画像編集アプリケーションを使用します。
ただしPhotoshopとGIMPはそのままではDDSに対応していませんのでプラグインを導入する必要があります。

NVIDIA Texture Tools for Adobe Photoshop
https://developer.nvidia.com/nvidia-texture-tools-adobe-photoshop

GIMP DDS Plugin
https://code.google.com/archive/p/gimp-dds/



■ PhotoshopまたはGIMPでDDSを開く場合

PhotoshopとGIMPどちらも開く場合にダイアログが表示されます。
ただし「Show this dialog」のチェックを外していると表示されません。

□ Photoshop

Load Using Default Sizes を選択します

Load MIP maps
Load Flipped Vertically
  どちらもチェックを外します


□ GIMP

Load mipmaps
  チェックを外します



■ アルファチャンネルを含んだDDSを編集するには

普通にアルファチャンネルを透明として扱っているならいいのですが、
ゲームではアルファチャンネルを透明以外の情報として扱う場合があります。（理由は色々あると思います）
DOA5LRの場合は濡れるとテクスチャが変わるオブジェクトに使われているディフューズマップ用テクスチャがこれになります。
（どちらもアルファチャンネルをスペキュラマップ用テクスチャとして使用しています）

paint.netはアルファチャンネルを透明としてしか扱えず、見た目が色々とおかしいものになります。
そのためアルファチャンネルを別にできて透明でない状態のものを編集できる画像編集アプリケーションが必要になります。
有名なものはPhotoshopやGIMPがあります。

GIMPでアルファチャンネルを含んだDDSを編集する場合は少しややこしいようですが、下記URLが参考になると思います。
http://doa5.webcrow.jp/?GIMP%E8%AC%9B%E5%BA%A7



■ ボリュームマップって何？

ノーマルマップ用のテクスチャを、
・Photoshopで開くと横に2つ並んだ画像になる
・GIMPで開くと2つのレイヤーになる
ものがあります。
これがボリュームマップと言われるものになります。
（正確には2つとは限りませんがDOA5LRの場合は2つのようです）

開いた時と同じ状態でボリュームマップとして保存すると正しく保存できます。
ボリュームマップが使われているオブジェクトは、ボリュームマップとして正しく保存したものを使用しないとゲーム上での表示がおかしくなる場合があります。その逆も同様です。



■ 作成・編集して保存する際の設定

□ Photoshop

メニューの ファイル → 別名で保存 をクリック
ファイル形式を「D3D/DDS」にして保存をクリックするとダイアログが表示されます。
以下の設定後、Saveをクリックすると保存します。

左上の項目（Saveの左）
  アルファチャンネルを使用している場合は DXT5 ARGB
  それ以外は DXT1 RGB
  --Pファイル用は 8.8.8.8 ARGB

その下の項目
  通常は 2D Texture
  ボリュームマップとして保存するなら Volume Texture
※ ボリュームマップとして保存する場合はキャンバスサイズの横が縦のちょうど2倍になっている必要があります

MIP Map Generation
  基本的には No MIP maps で問題ありません


□ GIMP

メニューの ファイル → 名前を付けてエクスポート をクリック
名前の最後を.ddsに（または右下のプルダウンを「DDS Image」に）してエクスポートをクリックするとダイアログが表示されます。
以下の設定後、OKをクリックすると保存します。

Compression
  アルファチャンネルを使用している場合は BC3 / DXT5
  それ以外は BC1 / DXT1
  --Pファイル用または濡れるとテクスチャが変わるオブジェクトのノーマルマップ用なら None

Format（CompressionでNoneを選んだ場合のみ）
  --Pファイル用またはアルファチャンネルがある場合は RGBA8（RGBA32で保存されます）
  それ以外は RGB8（RGB24で保存されます）

Save
  通常は Selected layer
  ボリュームマップとして保存するなら As volume map
※ CompressionをNone以外にしていると As volume map で保存できないようです

Mipmaps
  基本的には No mipmaps で問題ありません



■ 汚れ用テクスチャについて

TMCファイル内で複数の汚れ用テクスチャを設定した場合、
1つの汚れ用テクスチャのみが使用されるようです。

・TMCファイル内で最初に指定した汚れ用テクスチャになる？
・ステージによってはうまくいく？
といった情報もありますが、いずれにせよ汚れ用テクスチャは1つにするのがベストな解決策のようです。

少し古いものですが、1つにするにはこういった方法があります。
http://doa5.webcrow.jp/?%E3%83%8E%E3%83%BC%E3%83%9E%E3%83%AB%E3%83%9E%E3%83%83%E3%83%97%E8%A7%A3%E6%9E%90___%E6%B1%9A%E3%82%8C%E3%83%86%E3%82%AF%E3%82%B9%E3%83%81%E3%83%A3%E3%81%AEUV%E4%BF%AE%E6%AD%A3%E6%B3%95








皆様の道徳心とマナーをもったMODライフの一助となることを願って。
